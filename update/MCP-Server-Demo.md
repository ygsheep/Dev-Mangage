# 🚀 DevAPI Manager - MCP Server 可视化控制演示

## 📋 功能概述

DevAPI Manager 现在集成了完整的 **MCP (Model Context Protocol) Server 可视化控制系统**，提供强大的向量搜索和API管理能力。

## 🎯 核心特性

### ✨ 可视化控制界面

- **🖥️ 实时状态监控** - 服务器运行状态、端口、运行时间
- **📊 性能指标** - 请求计数、内存使用、数据库状态
- **🔍 向量搜索状态** - 模型加载状态、搜索算法类型
- **📜 实时日志流** - 服务器启动、运行、错误日志

### 🧠 智能搜索系统

- **向量语义搜索** - 使用 all-MiniLM-L6-v2 模型 (28.6MB Q4F16量化)
- **智能回退机制** - 网络问题时自动使用 TF-IDF 算法
- **混合搜索算法** - 结合关键词匹配和语义相似度
- **RAG增强检索** - 提供智能API推荐和上下文分析

### 🛠️ MCP工具集 (12个)

1. `search_projects` - 项目搜索
2. `search_apis` - API接口搜索
3. `search_tags` - 标签搜索
4. `global_search` - 全局搜索
5. `vector_search` - 向量语义搜索
6. `hybrid_search` - 混合搜索
7. `rag_search_apis` - RAG增强API搜索
8. `get_api_recommendations` - API推荐
9. `get_search_suggestions` - 搜索建议
10. `get_recent_items` - 最近项目
11. `refresh_search_index` - 刷新索引
12. `build_vector_index` - 构建向量索引

## 🚀 快速开始

### 1. 启动开发环境

```bash
# 方式1: 使用批处理脚本 (Windows)
start-dev.bat

# 方式2: 手动启动
cd packages/backend && npm run dev
cd packages/frontend && npm run dev
```

### 2. 访问控制界面

1. 打开浏览器访问: `http://localhost:5173`
2. 点击侧边栏 "设置" 进入设置页面
3. 选择 "MCP 服务器" 标签

### 3. 启动MCP服务器

1. 点击绿色 "启动服务器" 按钮
2. 观察实时日志输出
3. 查看服务状态指标

## 📊 界面功能详解

### 🎛️ 控制面板

- **启动/停止按钮** - 一键控制MCP服务器生命周期
- **重启按钮** - 快速重启服务器
- **日志开关** - 显示/隐藏实时日志输出

### 📈 状态监控

- **运行时间** - 服务器持续运行时长
- **请求计数** - API调用统计
- **数据库状态** - Prisma连接状态
- **向量搜索** - 模型类型和状态

### 🔍 搜索引擎状态

- **✅ 向量模型模式** - 深度学习语义搜索
  - 模型: all-MiniLM-L6-v2 (Q4F16量化)
  - 向量维度: 384
  - 优势: 高精度语义理解
- **⚠️ TF-IDF回退模式** - 关键词匹配搜索
  - 算法: TF-IDF + 余弦相似度
  - 大小: ~2MB
  - 优势: 快速响应、离线运行

### 📜 实时日志

- **启动过程** - 数据库连接、模型加载、索引构建
- **运行状态** - 搜索请求、性能指标、错误信息
- **彩色分级** - 信息/警告/错误日志着色显示

## 🎯 使用场景演示

### 场景1: 正常启动 (向量模型)

```
🚀 启动MCP服务器...
📁 数据库连接已建立
🔍 正在初始化向量搜索服务...
✅ 本地向量模型加载成功 (all-MiniLM-L6-v2)
🎯 构建搜索索引...
✅ MCP服务器已启动，监听端口 3000
🔧 已注册12个MCP工具
📊 搜索索引包含38个文档
```

### 场景2: 网络问题 (回退模式)

```
🚀 启动MCP服务器...
📁 数据库连接已建立
🔍 正在初始化向量搜索服务...
⚠️  向量模型加载失败，使用TF-IDF回退方案
🎯 构建搜索索引...
✅ MCP服务器已启动，监听端口 3000
🔧 已注册12个MCP工具
📊 搜索索引包含38个文档
```

## 🔧 技术架构

### 前端组件

- **MCPServerControl.tsx** - 主控制组件
- **SettingsPage.tsx** - 设置页面容器
- **mcpServerAPI.ts** - API通信接口

### 后端API

- **GET /api/mcp/status** - 获取服务器状态
- **POST /api/mcp/start** - 启动服务器
- **POST /api/mcp/stop** - 停止服务器
- **GET /api/mcp/logs** - 获取日志
- **GET /api/mcp/status/stream** - 状态流 (SSE)
- **GET /api/mcp/logs/stream** - 日志流 (SSE)

### MCP服务器

- **向量搜索服务** - 基于 Transformers.js
- **回退搜索算法** - TF-IDF + 余弦相似度
- **数据库持久化** - Prisma + SQLite
- **RAG增强系统** - 智能上下文分析

## 💡 核心优势

### 🛡️ 高可用设计

- **智能回退机制** - 网络问题时无缝切换算法
- **零停机保证** - 确保搜索服务始终可用
- **实时监控** - 状态异常及时发现和处理

### ⚡ 性能优化

- **本地模型缓存** - 减少网络依赖，提升加载速度
- **量化模型** - Q4F16量化版本平衡性能和精度
- **索引缓存** - 搜索索引内存缓存，响应<100ms

### 🎯 专业优化

- **API搜索特化** - 针对HTTP方法、路径、技术术语优化
- **中英文支持** - 支持中英文混合查询
- **多维度搜索** - 项目、API、标签全方位覆盖

## 🎉 总结

DevAPI Manager 的 MCP Server 可视化控制系统为开发者提供了:

- **🖥️ 直观的图形界面** - 无需命令行操作
- **📊 实时监控能力** - 全面掌握服务状态
- **🔍 智能搜索体验** - 语义理解 + 关键词匹配
- **🛡️ 高可用保障** - 智能回退 + 零停机设计
- **⚡ 极致性能** - 本地优化 + 专业算法

这套系统展示了现代化的 API 管理平台应该具备的完整功能：可视化控制、智能搜索、实时监控和高可用设计。无论是开发调试还是生产环境，都能提供稳定可靠的服务体验！ 🚀
