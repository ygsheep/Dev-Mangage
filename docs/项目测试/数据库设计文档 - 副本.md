### 2. 资讯内容系统 (News Content System)

#### 2.1 资讯分类表 (news_categories)
```sql
CREATE TABLE news_categories (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    name_en VARCHAR(50),
    description TEXT,
    icon_url VARCHAR(255),
    color_code VARCHAR(7),
    parent_id BIGINT NULL,
    sort_order INT DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    keywords JSON, -- 分类关键词，用于自动分类
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (parent_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    INDEX idx_parent_id (parent_id),
    INDEX idx_sort_order (sort_order)
);
```

#### 2.2 资讯来源表 (news_sources)
```sql
CREATE TABLE news_sources (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    website_url VARCHAR(255),
    rss_url VARCHAR(255),
    api_endpoint VARCHAR(255),
    source_type ENUM('rss', 'api', 'crawler') NOT NULL,
    credibility_score DECIMAL(3,2) DEFAULT 0.80, -- 可信度评分
    is_active BOOLEAN DEFAULT TRUE,
    crawl_interval INT DEFAULT 3600, -- 爬取间隔(秒)
    last_crawled_at TIMESTAMP NULL,
    config JSON, -- 爬取配置
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_source_type (source_type),
    INDEX idx_last_crawled (last_crawled_at)
);
```

#### 2.3 资讯元数据表 (news_metadata) 
```sql
CREATE TABLE news_metadata (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    source_id BIGINT NOT NULL,
    title VARCHAR(500) NOT NULL,
    summary TEXT,
    author VARCHAR(100),
    source_url VARCHAR(500) UNIQUE NOT NULL,
    cover_image_url VARCHAR(500), -- 封面图片
    published_at TIMESTAMP NOT NULL,
    crawled_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    language VARCHAR(10) DEFAULT 'zh-CN',
    category_id BIGINT,
    content_type ENUM('article', 'video', 'audio') NOT NULL, -- 内容类型
    tags JSON, -- 标签数组
    keywords JSON, -- 关键词数组
    sentiment_score DECIMAL(3,2), -- 情感分数 (-1到1)
    importance_score DECIMAL(3,2), -- 重要性分数 (0到1)
    view_count BIGINT DEFAULT 0, -- 浏览次数
    like_count INT DEFAULT 0, -- 点赞数
    share_count INT DEFAULT 0, -- 分享数
    comment_count INT DEFAULT 0, -- 评论数
    duration INT NULL, -- 音视频时长(秒)，文章为NULL
    is_processed BOOLEAN DEFAULT FALSE,
    is_duplicate BOOLEAN DEFAULT FALSE,
    duplicate_of BIGINT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (source_id) REFERENCES news_sources(id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    FOREIGN KEY (duplicate_of) REFERENCES news_metadata(id) ON DELETE SET NULL,
    INDEX idx_source_id (source_id),
    INDEX idx_published_at (published_at),
    INDEX idx_content_type (content_type),
    INDEX idx_category_id (category_id),
    INDEX idx_is_processed (is_processed),
    INDEX idx_importance_score (importance_score),
    INDEX idx_view_count (view_count),
    INDEX idx_is_active (is_active),
    FULLTEXT idx_search (title, summary)
);
```

#### 2.4 文章内容表 (article_content)
```sql
CREATE TABLE article_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    content TEXT NOT NULL, -- 文章正文内容
    html_content LONGTEXT, -- HTML格式内容
    markdown_content LONGTEXT, -- Markdown格式内容
    content_structure JSON, -- 内容结构化数据（章节、段落等）
    word_count INT DEFAULT 0, -- 字数统计
    read_time_estimate INT DEFAULT 0, -- 预估阅读时间(分钟)
    tts_enabled BOOLEAN DEFAULT TRUE, -- 是否支持TTS
    tts_script TEXT, -- TTS专用脚本（优化语音播报）
    related_images JSON, -- 文章内图片数组
    related_links JSON, -- 相关链接
    seo_description VARCHAR(500), -- SEO描述
    seo_keywords VARCHAR(300), -- SEO关键词
    content_quality_score DECIMAL(3,2), -- 内容质量评分
    readability_score DECIMAL(3,2), -- 可读性评分
    is_original BOOLEAN DEFAULT FALSE, -- 是否原创
    plagiarism_check_result JSON, -- 查重结果
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_news_article (news_id),
    INDEX idx_word_count (word_count),
    INDEX idx_read_time (read_time_estimate),
    INDEX idx_quality_score (content_quality_score),
    INDEX idx_tts_enabled (tts_enabled),
    FULLTEXT idx_content_search (content, tts_script)
);
```

#### 2.5 视频内容表 (video_content)
```sql
CREATE TABLE video_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    video_url VARCHAR(500) NOT NULL, -- 视频文件URL
    backup_video_urls JSON, -- 备用视频URL数组
    thumbnail_url VARCHAR(500), -- 缩略图
    poster_url VARCHAR(500), -- 海报图
    duration INT NOT NULL, -- 视频时长(秒)
    resolution VARCHAR(20), -- 分辨率 1080p, 720p等
    file_size BIGINT, -- 文件大小(字节)
    bitrate INT, -- 比特率
    frame_rate DECIMAL(4,2), -- 帧率
    format VARCHAR(10) DEFAULT 'mp4', -- 视频格式
    codec VARCHAR(50), -- 编码格式
    subtitle_urls JSON, -- 字幕文件URL数组
    chapter_info JSON, -- 章节信息
    video_quality ENUM('sd', 'hd', '4k') DEFAULT 'hd',
    is_live BOOLEAN DEFAULT FALSE, -- 是否为直播
    live_stream_url VARCHAR(500), -- 直播流地址
    transcription TEXT, -- 视频转录文字
    video_tags JSON, -- 视频标签
    video_description TEXT, -- 视频描述
    upload_status ENUM('uploading', 'processing', 'completed', 'failed') DEFAULT 'completed',
    cdn_distribution JSON, -- CDN分发信息
    play_count BIGINT DEFAULT 0, -- 播放次数
    download_count INT DEFAULT 0, -- 下载次数
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_news_video (news_id),
    INDEX idx_duration (duration),
    INDEX idx_resolution (resolution),
    INDEX idx_video_quality (video_quality),
    INDEX idx_is_live (is_live),
    INDEX idx_play_count (play_count),
    INDEX idx_upload_status (upload_status),
    FULLTEXT idx_transcription_search (transcription, video_description)
);
```

#### 2.6 音频内容表 (audio_content)
```sql
CREATE TABLE audio_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    audio_url VARCHAR(500) NOT NULL, -- 音频文件URL
    backup_audio_urls JSON, -- 备用音频URL数组
    duration INT NOT NULL, -- 音频时长(秒)
    file_size BIGINT, -- 文件大小(字节)
    bitrate INT, -- 比特率
    sample_rate INT, -- 采样率
    format VARCHAR(10) DEFAULT 'mp3', -- 音频格式
    codec VARCHAR(50), -- 编码格式
    voice_type VARCHAR(50), -- 语音类型(AI生成/真人录制)
    voice_gender ENUM('male', 'female', 'mixed') DEFAULT 'female',
    speech_rate DECIMAL(3,1) DEFAULT 1.0, -- 语速倍率
    volume_level DECIMAL(3,2) DEFAULT 1.0, -- 音量级别
    transcription TEXT, -- 音频转录文字
    chapter_timestamps JSON, -- 章节时间戳 [{"title":"...", "start":0, "end":30}]
    related_article_id BIGINT NULL, -- 关联的文章内容ID(支持音频+文章联动)
    sync_reading_enabled BOOLEAN DEFAULT FALSE, -- 是否支持同步阅读
    sync_reading_data JSON, -- 同步阅读数据(文字高亮时间戳)
    audio_quality ENUM('low', 'medium', 'high') DEFAULT 'medium',
    generation_method ENUM('tts', 'human', 'ai_clone') DEFAULT 'tts',
    tts_config JSON, -- TTS生成配置
    background_music_url VARCHAR(500), -- 背景音乐URL
    audio_effects JSON, -- 音效配置
    download_enabled BOOLEAN DEFAULT TRUE, -- 是否允许下载
    offline_enabled BOOLEAN DEFAULT TRUE, -- 是否支持离线
    play_count BIGINT DEFAULT 0, -- 播放次数
    download_count INT DEFAULT 0, -- 下载次数
    completion_rate DECIMAL(5,2) DEFAULT 0, -- 平均完成率
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    FOREIGN KEY (related_article_id) REFERENCES article_content(id) ON DELETE SET NULL,
    UNIQUE KEY unique_news_audio (news_id),
    INDEX idx_duration (duration),
    INDEX idx_voice_type (voice_type),
    INDEX idx_generation_method (generation_method),
    INDEX idx_related_article_id (related_article_id),
    INDEX idx_sync_reading_enabled (sync_reading_enabled),
    INDEX idx_play_count (play_count),
    INDEX idx_completion_rate (completion_rate),
    FULLTEXT idx_transcription_search (transcription)
);
```
